# Notion Database Batch Replace

一款专为 Notion 设计的数据库内容批量替换油猴脚本。通过模拟人工点击与 Z 字形自动滚动逻辑，突破了 Notion 虚拟列表（Virtual List）渲染的限制，支持跨列、跨页面的深度查找与替换。

## 🌟 核心功能

- **Z 字形深度扫描**：自动执行“横向滚动遍历列 -> 纵向滚动翻页”的逻辑，确保处理到数据库中的每一个单元格。
- **精准单元格定位**：修复了 Notion 常见的“选中整行”问题，直接穿透至单元格编辑器内部。
- **防劫持输入框**：特殊的事件拦截机制，确保在脚本 UI 界面内可以正常使用 `Ctrl+A` (全选)、`Ctrl+V` (粘贴) 等快捷键，不受 Notion 快捷键干扰。
- **交互式 UI**：
  - **可拖拽**：支持面板标题栏拖拽，灵活调整位置。
  - **收缩隐藏**：一键收缩为悬浮图标，图标同样支持自由拖拽。
  - **图标锚定**：面板始终相对于图标向左扩展，完美适配屏幕边缘。
- **安全机制**：支持 `ESC` 键紧急停止，防止误操作。

## 🛠️ 安装方法

1. **安装插件**：首先在浏览器中安装 [Tampermonkey](https://www.tampermonkey.net/)（油猴）插件。
2. **创建脚本**：
   - 点击油猴图标，选择“添加新脚本”。
   - 将 `Notion Database Batch Replace-1.0.0.user.js` 中的代码复制粘贴。
3. **保存**：按下 `Ctrl + S` 保存。
4. **运行**：打开任意 Notion 数据库页面，页面右上角将出现自定义的蓝色图标。

## 🚀 使用指南

1. **打开数据库**：进入你需要修改的 Notion 表格视图。
2. **展开面板**：点击右上角的悬浮图标展开操作面板。
3. **配置参数**：
   - 在 **“查找内容”** 中输入你想要替换的原始文本。
   - 在 **“替换为”** 中输入新的文本。
4. **执行替换**：点击 **“开始自动替换”**。
   - 脚本将开始自动滚动。此时建议不要手动操作页面，以免干扰模拟点击。
   - 如需中途停止，请点击红色的 **“停止扫描”** 按钮或按下键盘 **`ESC`** 键。
5. **完成**：扫描完成后，状态栏会显示成功替换的总数。

## ⚠️ 注意事项

- **数据备份**：在执行大规模批量替换前，**强烈建议先手动复制/备份数据库**或通过 Notion 的页面历史记录功能确保安全。
- **列类型支持**：本脚本主要支持 **Text (文本)**、**Number (数字)**、**URL**、**Email** 等可直接编辑的列。对于“关联 (Relation)”或“人员 (Person)”等特殊属性，脚本可能无法自动完成替换。
- **网络延迟**：如果你的 Notion 数据库条目非常多且网络加载较慢，建议在代码中适当调大 `sleep` 时间以保证 DOM 渲染完成。

## 📜 更新日志

- **v1.0.0**：优化 UI 锚定逻辑，修复输入框快捷键被 Notion 劫持的问题，引入 Z 字形自动滚动扫描引擎。

------

## 免责声明

本工具仅供学习和工作效率提升使用。使用本脚本所产生的所有数据变更后果由使用者自行承担。建议在正式操作前在测试数据上先行验证。